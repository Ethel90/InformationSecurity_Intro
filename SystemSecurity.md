## __System Security__
### __系統管理__
- what is 系統安全？
    - 保存個人資料(Credential information)
    - 資料的安全性及保密性(Through "access control" to achieve)
    - 系統正常運作(符合可用性availability)

- 存取控制Access Control：是每一個主體(Subject)依其權限(Permission) 以存取各項客體(Object)資源的控管方法。

    - 主體(Subject-> Person)
    ```
    通常是使用者，也可以是執行中的程式
    ```
    - 客體(Object -> File)
    ```
    是各種電腦資源，如：檔案、資料庫等
    ```
    - 權限(Permission -> Read/Write ; Grant/Deny)
- 隨意型存取控制 (Discretionary Access Control, DAC)

    - 優點：簡單
    - 缺點：存取控制矩陣越來越大，維護很麻煩
- 強制型存取控制 (Mandatory Access Control, MAC)
```
- 存取物件及使用者間強制定了不同的安全等級
極機密 (TS)、機密 (S)、密 (C)、 與一般類(U)四種安全等級

    **等級的關係 TS>S>C>U
    
- 存取法則應遵循Bell-LaPadula模式的二個策略
「禁止往上讀」(No Read Up)
「禁止往下寫」(No Write-Down)
```
- 存取控制清單 (Access Control List, ACL)
    - 優點：簡單易懂
    - 缺點：維護上不易

        - 集中管理
        - 清單內容(人員, 物件, 權限)
            - 權限分成
                - 讀(Read)
                - 寫(Write)
                - 修改(Update)
                - 刪除 (Delete)

            - 授權型態 
                - 授權(Grant) 
                - 拒絕 (Deny)
- 角色為單位的存取控制(Role-based Access Control, RBAC)
```
一個角色有多個使用者

    - 角色權限階層式 (Role Hierarchy)
    上位者 (Senior Role) 及 下位者 (Junior Role)
       => 上位者(senior role)可以讀下面的權限，但不一定可以寫，而下位者(junior role)不可讀寫上面的權限
    - 權責分制 (Mutually Exclusive)
        => (e.g. 採購部與會計部)
```
- 虛擬專屬網路(VPN)
```
可採用VPN方式建置網路來降低危險性，但成本高
```
### __軟體安全簡介__
#### 常見的安全威脅
- 緩衝區溢位攻擊(Buffer Overflow)
    - 利用ITS4來偵測來防止緩衝區溢位
    - 若程式設計者在設計讀取輸入值至緩衝區時也忽略了檢查輸入值長度時，攻擊者就可以透過輸入一筆較長的資料，以造成程式癱瘓或改變執行流程，通常會搭配 Shellcode 可以執行任意程式碼，而且同時擁有受害程式的權限。
```
緩衝區溢位的問題：
- 覆蓋附近資料，影響資料的正確性
- 除錯困難
- 侵害到其他程式，造成程式的錯誤執行

所造成的安全威脅：
- 重要資料的竊取
**盜用系統的最高權限
```
> 緩衝區(Buffer)是指儲存資料的記憶體位置若資料量太大造成溢出 
- 競爭條件(Race Condition)
> 多工的執行環境
```
發生時的表現通常會是：
1.程式隨機出現一些不一樣的結果 
2.程式失控 (停不下來、程式程序亂跳) 

最常也最容易發生的原因通常是因為變數的濫用，由於區域變數或全域變數的使用打破了資料流的概念，造成執行的時間與順序不容易預期。
```
- 隨機值預測
    - 隨機數 (Random Number)對於唯一性、加密的安全來說是非常重要的
    - 不正確的使用隨機值會讓攻擊者有機會獲得重要的安全資訊
- 程式漏洞的安全檢查

    - 動態檢查
        - 程式執行的狀態之下，進行安全檢查的動作(將系統程式的編譯器加上安全檢查能力載入進行安全檢查的函式庫)
        - 缺點：增加程式執行的負擔

    - 靜態檢查
        - 根據可能會出現的弱點，建立測試程式進行檢查
        - 著眼於未編譯過的原始檔
        - 修正不安全的程式片段
        - 不會造成程式執行的負擔
        - 缺點：無法對所有的缺點做檢測，則即使通過這個測試也不能保證沒有弱點的存在

- 輸入參數確認(Input Validation)
    - 保全防護
        - 就像門禁控管，以防止未經授權人員進出
    - 基本原則
        - 使用白名單
        - 拒絕整份含有惡意資料的輸入
        - 檢查各種可能的狀況
#### 密碼程序和程式安全的關係
- 完整性(Integrity)
    -  利用SHA雜湊演算法計算出雜湊值，若收方及送方的雜湊值皆相同，必須文件在傳送途中沒有遭竄改或傳送錯誤
- 來源認證性 (Authentication)及不可否認性 (Non-repudiation)
    - 金鑰必須被收方及送方妥善保管，一旦密文可以順利被金鑰解開，就認為它是從送方送來的
#### 軟體的錯誤安全測試
- 白盒測試 (White-Box)
    - 隱藏在軟體中，當缺失發現時即觸發
    - 使用Assertion來觸發隱藏在軟體中不易被發現的缺失，以增加程式的可測試性
- 黑盒測試 (Block-Box)
    - 一般輸入資料是正常的Input時，程式就會產生正常的output，故可依據輸出結果來判定是否有缺失

- STRIDE
```
身份欺騙 (Spoofing Identity)
竄改資料 (Tampering with Data)
否認 (Repudiation)
資訊公開 (Information Disclosure)
拒絕服務 (Denial of Service, DoS) 
提高權限 (Elevation of Privilege)
```
### __硬體安全簡介__
- 硬體鎖(Keypro)
    - 輸出入轉接頭之硬體安全裝置
    - 將固定之檢查碼存於硬體鎖中
    - 軟體執行時，會先偵測其所搭配之硬體鎖是否已插在電腦上
- 防火牆結構
    - 雙介面主機(Dual-Homed Host)
        - 藉由連接不同網路主機來提供服務，將IP封包由一個網路引導至另一個網路，但系統之間不能直接通訊，必須由雙介面主機之間的傳輸。
    - 屏蔽式主機(Screened Host)
    - 屏蔽式子網路(Screened Subnet)
#### 封包過濾器的攻擊
- IP 位址的偽裝(IP Spoofing)
    - 入侵者將封包的來源IP位址設定成某台內部的主機 ，藉此躲過防火牆的安全檢查
- 來源路徑攻擊法
    - 由於來源端可以指定封包在網路中的走訪路徑，如果安全機制不會去分析這個路徑資訊是否安全的話，那麼攻擊者便藉著沒有此安全檢查來達到攻擊的目的
- 細微區段攻擊法
    - 入侵者利用切割IP封包的方法來產生較小的區段，並將此較小的區段植入另一個封包區段中，來避開安全性檢查
- 虛擬亂數產生器 (Pseudorandom Number Generator, PRNG)
- 非法竄改偵測感應器
    - 可偵測高低溫、輻射及反常的電力
#### 硬體密碼模組之安全攻擊
- 物理密碼攻擊法
    - IC卡是密碼學原理下的產品
    - 不需要去破解與密碼系統相關的數學難題，只需具備基本的統計運算技巧
- 電力攻擊法
    - 偵測電腦運算時所消耗之電力再進行攻擊
    - 觀察比較電量消耗的高低來判斷私密金鑰值
```
電力攻擊法防禦方法：
- 隨機延遲(Random Delay)：在運算過程中插入一些無意義的運算或是一些隨機時間，使攻擊者無法精確地計算出運算發生時間
- 加入雜訊(Add Noises)：藉在電力消耗波型上加入雜訊，讓攻擊者無法區分出正確的電量消耗值
```
- 時間攻擊法
    - 藉由不同資料在運算時，其所用的時間不同，再經由測量加解密的執行時間來推算出加密時使用的私密金鑰值
    - 主要攻擊的目標是公開金鑰密碼系統
        - 執行時間會根據私密金鑰不同而改變
    - 較為困難
        由於電腦執行的速度很快，要正確地抓住測量時間點並不容易，需要極精密的儀器才能測量出來
```
時間攻擊之防禦方法：
- 修改演算法：使其執行消耗之時間為一定值，但並非所有的演算法都可輕易地達到此修改目的
- 加入隨機的運算：跟電力分析防禦法中的概念是一樣
```
- 硬體錯誤攻擊法
    - 電腦執行過程中可能會產生錯誤，而這些錯誤的結果會影響系統的安全
        - 利用儀器來使電腦產生錯誤，進而達到攻擊的目的
        - 利用某些特殊儀器干擾電腦系統，使加解密過程中產生錯誤，並把這些錯誤的值存入暫存器及記憶體
        - 實作不適當的密碼系統，會導致密碼系統無法達到理論上的安全性
- IC卡
    - 具有記憶能力更有運算能力
    - 有能力可抵擋IC外部的攻擊
    - 發展趨勢
        - IC卡之功能與記憶體容量也越來越大，運算速度越來越快速 
```
- 內部結構分為記憶卡及CPU卡
記憶卡：EEPROM、Flash、ROM及RAM
CPU卡：IC卡內含CPU

- 介面方式:接觸式及非接觸式
接觸式IC卡：須透過特定之讀卡設備才能夠與IC卡進行通訊(e.g. 晶片)
非接觸式IC卡：不需要與IC卡直接接觸便可使用無線電波與IC卡通訊
```
- 之存取控制系統主要包含在檔案存取部分，其分為五種層級
    - 任何人皆可存取 (Always, ALW) 
    - CHV1才能存取 (Card Holder Verification 1, CHV1) 
    - CHV2才能存取 (Card Holder Verification 2, CHV2)
    - 只有管理者可存取 (Administrative, ADM)
    - 沒有任何人可以存取 (Never, NEV)
> 權限高->低：ALW>CHV>ADM>NEV
- 美國聯邦資訊處理標準(Federal Information Processing Standards, FIPS 140-2) 
    - 密碼模組硬體安全之檢測
- 密碼模組硬體安全等級
```
安全等級一：基本的防護
安全等級二：一般的防護
安全等級三：嚴謹的防護
安全等級四：嚴密的防護
```
#### [入侵偵測](https://github.com/Ethel90/InformationSecurity_Intro/blob/main/IDS.png)
- 入侵偵測系統 (Intrusion Detection System, IDS)
    - 功能四部份
        1. 截取原始資料
        2. 抽取特徵
        3. 分析特徵
        4. 事件回應
- 誤用偵測(Misuse Detection)
    - 明確定出異常的行為模式
    - 負面行為模式 (Negative Behavior Model)
- 異常偵測 (Anomaly Detection)
    - 明確定出正常的行為模式
    - 正面行為模式 (Positive Behavior Model)
    - 偵測率高但其誤判率也高
- 網路型入侵偵測系統(Network-based IDS, NIDS)
    - 優點
        1. 可監控的範圍很廣
        2. 安裝或升級時，對整個網路環境影響最小
        3. 與作業系統獨立
        4. 可偵測到網路層的問題
    - 缺點
        1. 因監控的範圍很廣，所以會頻頻發出許多錯誤警告
        2. 只能偵測已知的攻擊行為
        3. 在擁塞的路環境裡，很難處理封包
- 主機型入侵偵測系統(Host-based IDS, HIDS)
    - 優點
        1. 可確定攻擊成功與否
        2. 可發現網路型未發現的入侵
        3. 可避免阻斷服務攻擊
    - 缺點
        1. 若主機遭受攻擊，HIDS就無法運作
        2. HIDS無法偵測到整個網路所偵測到的攻擊
        3. HIDS需要佔用系統資源，可能會影響主機效能
- 分散式入侵偵測系統
    - 與傳統最大不同是它會找出不同資料來源間的關係
    - 能收集自不同的主機或網域的資訊，再分析這些不同資料的關係，以做為偵測不同主機的入侵行為
- 防火牆(firewall)
    - 封包過濾 (Packet Filter)
        - 來源IP位址、TCP/UDP來源埠、目的IP位址、TCP/UDP目的埠
    - 狀態檢視 (Stateful Inspection or Dynamic Packet Filter)
        - 動態封包檢視防火牆
        - 封包的來源和目的IP位址、埠號碼、使用者、時間及所要求的服務來作判斷
    - 應用程式代理 (Application Proxy) 
        - 在防火牆上模擬網路連線的來源和目的地兩端來模擬其網路協定
    - `無法防範病毒`
- 授權控制
    - 需要才給存取權(Need-to-Know Policy)
        - 給予使用者適當或最小滿足其存取資料項存取權
    - 最大分享策略(Maximized Sharing)
        - 絕大部分資源均可存取，僅將少數重要機密予以保護
    - 開放式及封閉式系統
        - 除非有明文禁止，在開放式系統內資源大多可被存取
        - 除非有明文特別允許，否則在封閉式系統內絕大資源禁止被存取使用
     - 名稱相關存取控制(Name-Dependent Access Control)
        - 依每個人的名稱有不同的存取權限
### __可信賴電腦簡介__
> 具體的概念是由TCPA聯盟(TCG的前身)率先提出
- ISO/IEC 15408標準
    - 可信賴的元件
    - 操作的行為是可預測的
    - 能抵抗惡意程式軟體、病毒及其他物理干擾的破壞
    - 可信賴性應
        - 可用性、可靠性、強健性、可維護性、安全性及可測試性
- TCG制定三個基本規範
    - 私密性(Confidentiality)
    - 鑑別性(Authentication)
    - 完整性(Integrity)
- TPM 晶片
    - 是搜集一些與系統和資訊安全相的微晶片
    - 用來進行各種與資訊安全相關的基本運算功能
    - Wrapping Key或Binding Key
        - 可自行產生多組密鑰並將此密鑰以加密方式來加以保護，且確保只能由TPM 晶片解密取得這些密鑰
        - 此密鑰我們把它稱為SRK (Storage Root Key)