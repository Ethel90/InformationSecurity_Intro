## __Database Security__

### __資料庫管理系統安全威脅__
- 資料庫的安全需求
    1. 資料面
        - 機密性(Confidentiality) 
            - 具機密性質的資料需要由適當的方法來保護
        - 完整性(Integrity)
            - 應防範被有意或無意的使用者破壞或篡改資料 
        - 可用性(Availability) 
            - 一旦資料庫遭受攻擊造成某種程度的損毀時，應能迅速恢復正常運作的能力 
    2. 資料使用者
        - 身份識別(Authentication)
            - 使用前先以身份識別法證明使用者本身身份
        - 授權 (Authorization)
            - 使用資料庫系統時，被授予合理的存取權限範圍
        - 不可否認性(Non-repudiation) 
            - 使用者在所有存取作業之後不能夠加以否認
    3. 管理者
        - 追蹤所有的操作紀錄，資料庫稽核(Auditing) 
        - 可從系統日誌(System Log)發現及得知問題點
- 網路系統層次的安全防範技術：
    - 防火牆
        - 主要作用是監控可信任網路和不可信任網路之間的連線通道
        - 攔截來自外部的非法連線並阻止內部資訊的外漏
        - 但無法阻攔來自`網路內部`的非法操作。 
    - 入侵檢測(Intrusion Detection System, IDS) 
        - 監控網路和電腦系統是否出現被入侵或濫用的徵兆 
    - 協同互助式入侵檢測技術
        - IDS基於一種統一的規範，入侵監測元件之間自動地交換資訊，並且通過資訊的交換得到了對入侵的有效監測
- DBMS(Database Management System)內核心層
    - 直接透過外部保密器對資料庫檔案進行加密
    - 加密功能強，不會影響DBMS的功能
    - 缺點是加密運算在伺服器端進行，加重伺服器的負載
- DBMS外層
    - 資料庫加密系統做成DBMS的一個外層工具，加/解密運算可在用戶端進行
    - 不會加重資料庫伺服器的負載並且可以實現網路上傳輸的加密
    - 缺點是加密功能與資料庫管理系統之間的整合比較複雜 
```
cipher在server端會加重負擔
cipher在client端不會加重負擔
cipher在server端是明文
cipher在client端是密文
```
### __統計資料庫安全__
- 查詢限制(query restriction)
    - 若使用者不符合統計資料庫的限制條件時，統計資料庫就不予回答
    - 在於群組資料中，可以指定所回傳的資料筆數的最低門檻
    - 低於此資料筆數，就不允許執行任何統計資料的查詢
    - 讓資料查詢來推導個別資訊的可能性可以被降低 
- 加解密的保護方法
    - 利用密碼學技術將資料以密文的型式存放在資料庫內
- 資料庫加密法
    - 資料列導向(Record Oriented)
        - 加密保護是將單一筆資料列加密成一個密文 
    - 欄位導向(Field Oriented)
        - 提出採用以欄位為基礎的加密保護方式，利用金鑰產生器產生不同的加密金鑰
        - 以欄位為主的加密機制
        - SA帳號 -> 一個
        - dbo(Database owner)帳號 -> 多個
            - 擁有資料庫所有的權限並可授權給其他使用者 
- SQL Server中使用三種權限類型：
    - 物件權限（Object permissions）
        - 控管著資料表、檢視、欄位與預存程序的存取權限 
    - 敘述權限（Statement permissions）
        - 只有系統管理者伺服器角色的成員與資料庫擁有者可以設定敘述權限 
        - 建立一個資料庫或加入一個物件到資料庫 
    - 暗示權限（Implicit permissions）
        - 系統管理者角色或資料庫擁有者成員
        - 允許他們執行所擁有的資料庫與資料庫物件的所有活動，如背景程序之執行、可看所有資料
### __任意式資料庫安全__
> 只要不是`關聯式資料庫`、`階層式資料庫`、`物件導向資料庫`的系統，都把它歸於任意資料庫系統
    >> 資料庫隨著需求去做設定(e.g. txt檔、xml -> 最常見資料庫型態)
- Access資料庫保護方法
    - 非一般化的命名方式
        - Access資料庫檔名盡量不要使用簡單的名稱
    - 使用ODBC連線
        - 在寫程式時，不再直接連接到DB，而是先到ODBC（一個介面可設定成MyDB, SQL Server等）再由其連到DB
- XML與傳統加密最大不同
    - 可做到fine-grained簽章(細緻化)
        - 只對局部資料做加密，而不是只能針對一整份文件進行簽章
    - 可達到給很多人使用同一份文件，針對不同的人去做簽章
### __多層式資料庫安全__
> [階層式資料庫與關聯性資料庫](https://raw.githubusercontent.com/Ethel90/Photo/main/InformationSecurity_Intro/DBComparison.png?token=AOYZYZWY5ROWD5UQ757GXOS77KQKE)
- 階層式資料庫(Hierarchical database, HDB)
    - 為一個樹狀結構（根節點到子節點）
    - 方便有效管理授權
    - 查詢時間（樹高）是以log2為底的n
    - 只適用於一對多的關係，不適用於多對多的關係
#### 用戶身份認證
- 匿名認證
    - 不對用戶進行認證，本方法僅適用於不重要資訊的完全公開方式。
    - 一般都會具有支援匿名認證的功能，只提供給用戶查詢不重要資訊的權限
- 基本認證
    - 通過用戶名稱和密碼進行身份識別，又分為簡單密碼和摘要密碼認證。
    - 用戶端密碼是`明文`形式，存在安全問題 

#### 權限控管
- 存取控制語言(Access Control Language, ACL)
    - 誰可以讀Server的哪些資料
    - 作權限的控管
    - 符合RFC2254規範
#### 安全通道的建立
> 為了保護資料的機密性完整性和防止阻絕服務攻擊(DoS)，在用戶端與伺服器端之間建立安全連線通道來保護請求與回應訊息
>> LDAP中提供了基於SSL/TLS的通訊安全保障
>>>提供通訊中的資料保密性、完整性保護
- Openldap LDAP Server設定檔
    - 檔名為slapd.conf 
- SSL
    - 僅驗證到底是不是合法的使用者（單向驗證）
    - 使用`636`作為LDAP SSL的port number
- TLS
    - 比SSL更安全
    - 會驗證使用者&Server（雙向驗證）
- 最高管理者代稱
    - root/sa
### __資訊隱碼攻擊__
- 資訊隱碼攻擊(SQL Injection)
    - SQL是查詢DB的語法
    - 利用SQL程式撰寫上的疏忽，使攻擊者可藉由DB條件查詢的功能，輸入「非預期性輸入格式」，便可避開SQL安全檢查，非法存取資料庫中的內容並回傳
    - 目前受到影響的系統包括MS SQL、MySQL、Oracle、Sybase與DB2等
> 寫PHP、JSP、ASP時就要檢查是否安全
>> 要check程式碼內是否有[特殊符號](https://raw.githubusercontent.com/Ethel90/Photo/main/InformationSecurity_Intro/SQLInjection.png?token=AOYZYZXW3Z3PUJJBDLDLJ6S77KU42)(1=1 -- 是SQL的註解 = , ')